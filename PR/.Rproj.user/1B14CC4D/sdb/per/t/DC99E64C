{
    "collab_server" : "",
    "contents" : "shinyServer(function(input, output) {\n  \n  output$mon_radar_asso <- renderPlot({\n    \n    qualite_asso_indiv <- questionnaire_qualites %>% \n      filter(Associe == input$consultant_id) %>% \n      mutate(qualite = factor(qualite))\n   \n    mon_radar_plot <- qualite_asso_indiv %>%\n      filter(ID_consultant == ID_cible) %>% \n      ggplot(aes(x = qualite, y = score)) +\n      geom_col(alpha = 0.5, \n               width = 1, show.legend = FALSE, color = \"white\", aes(fill = factor(score))) +\n      geom_hline(yintercept = seq(0, 3, by = 1),\n                 colour = \"#949494\", size = 0.5, lty = 3) +\n      geom_vline(xintercept = seq(0.5, 3.5, 1),\n                 colour = \"#949494\", size = 0.4, lty = 1) +\n      coord_polar() +\n      scale_fill_manual(values = c(\"1\"= \"#DE002C\", \"2\" = \"#E69F00\",\"3\"  =\"#009E73\")) +\n      scale_y_continuous(\n        limits = c(0, 3), \n        breaks = c(1, 2, 3, 4)) + \n      labs(x = \"\", y = \"\",\n           title = \"Mon avis sur moi-même\") + \n      theme(\n        panel.background = element_rect(fill = \"#FFFFFF\"),\n        plot.background = element_rect(fill = \"#FFFFFF\"),\n        strip.background = element_rect(fill = \"#FFFFFF\"),\n        strip.text = element_text(size = 15),\n        panel.grid = element_blank(),\n        axis.ticks = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_text(size = 7),\n        panel.spacing = grid::unit(2, \"lines\"))\n    \n    global_radar_plot <- qualite_asso_indiv %>%\n      group_by(qualite) %>% \n      summarise(score = mean(score)) %>%\n      mutate(couleur= factor(round(score))) %>%\n      ggplot(aes(x = qualite, y = score)) +\n      geom_col(alpha = 0.5, \n               width = 1, show.legend = FALSE, color = \"white\", aes(fill = couleur)) +\n      geom_col(aes(x = qualite, y = score), \n               data = qualite_asso_indiv %>% filter(ID_consultant == ID_cible), \n               alpha = 0.01,\n               width = 1, show.legend = FALSE, color = \"black\") +\n      geom_hline(yintercept = seq(0, 3, by = 1),\n                 colour = \"#949494\", size = 0.5, lty = 3) +\n      geom_vline(xintercept = seq(0.5, 3.5, 1),\n                 colour = \"#949494\", size = 0.4, lty = 1) +\n      coord_polar() +\n      scale_fill_manual(values = c(\"1\"= \"#DE002C\", \"2\" = \"#E69F00\",\"3\"  =\"#009E73\")) +\n      scale_y_continuous(\n        limits = c(0, 3), \n        breaks = c(1, 2, 3, 4)) + \n      labs(x = \"\", y = \"\",\n           title = \"L'avis moyen du cabinet\") + \n      theme(\n        panel.background = element_rect(fill = \"#FFFFFF\"),\n        plot.background = element_rect(fill = \"#FFFFFF\"),\n        strip.background = element_rect(fill = \"#FFFFFF\"),\n        strip.text = element_text(size = 15),\n        panel.grid = element_blank(),\n        axis.ticks = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_text(size = 7),\n        panel.spacing = grid::unit(2, \"lines\"))\n    \n    know_radar_plot <- qualite_asso_indiv %>%\n      semi_join(questionnaire_connaissance %>% filter(response == \"Je connais\"),\n                by = \"ID_consultant\") %>% \n      group_by(qualite) %>% \n      summarise(score = mean(score)) %>%\n      mutate(couleur= factor(round(score))) %>%\n      ggplot(aes(x = qualite, y = score)) +\n      geom_col(alpha = 0.5, \n               width = 1, show.legend = FALSE, color = \"white\", aes(fill = couleur)) +\n      geom_col(aes(x = qualite, y = score), \n               data = qualite_asso_indiv %>% filter(ID_consultant == ID_cible), \n               alpha = 0.01,\n               width = 1, show.legend = FALSE, color = \"black\") +\n      geom_hline(yintercept = seq(0, 3, by = 1),\n                 colour = \"#949494\", size = 0.5, lty = 3) +\n      geom_vline(xintercept = seq(0.5, 3.5, 1),\n                 colour = \"#949494\", size = 0.4, lty = 1) +\n      coord_polar() +\n      scale_fill_manual(values = c(\"1\"= \"#DE002C\", \"2\" = \"#E69F00\",\"3\"  =\"#009E73\"))+\n      scale_y_continuous(\n        limits = c(0, 3), \n        breaks = c(1, 2, 3, 4)) + \n      labs(x = \"\", y = \"\",\n           title = \"Ceux qui me connaissent\") + \n      theme(\n        panel.background = element_rect(fill = \"#FFFFFF\"),\n        plot.background = element_rect(fill = \"#FFFFFF\"),\n        strip.background = element_rect(fill = \"#FFFFFF\"),\n        strip.text = element_text(size = 15),\n        panel.grid = element_blank(),\n        axis.ticks = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_text(size = 7),\n        panel.spacing = grid::unit(2, \"lines\"))\n    \n    dont_know_radar_plot <- qualite_asso_indiv %>%\n      semi_join(questionnaire_connaissance %>% filter(response == \"Je ne connais pas\"),\n                by = \"ID_consultant\") %>% \n      group_by(qualite) %>% \n      summarise(score = mean(score)) %>%\n      mutate(couleur= factor(round(score))) %>%\n      ggplot(aes(x = qualite, y = score)) +\n      geom_col(alpha = 0.5, \n               width = 1, show.legend = FALSE, color = \"white\", aes(fill = couleur)) +\n      geom_col(aes(x = qualite, y = score), \n               data = qualite_asso_indiv %>% filter(ID_consultant == ID_cible), \n               alpha = 0.01,\n               width = 1, show.legend = FALSE, color = \"black\") +\n      geom_hline(yintercept = seq(0, 3, by = 1),\n                 colour = \"#949494\", size = 0.5, lty = 3) +\n      geom_vline(xintercept = seq(0.5, 3.5, 1),\n                 colour = \"#949494\", size = 0.4, lty = 1) +\n      coord_polar() +\n      scale_fill_manual(values = c(\"1\"= \"#DE002C\", \"2\" = \"#E69F00\",\"3\"  =\"#009E73\")) +\n      scale_y_continuous(\n        limits = c(0, 3), \n        breaks = c(1, 2, 3, 4)) + \n      labs(x = \"\", \n           y = \"\",\n           title = \"Ceux qui ne me connaissent pas\") + \n      theme(\n        panel.background = element_rect(fill = \"#FFFFFF\"),\n        plot.background = element_rect(fill = \"#FFFFFF\"),\n        strip.background = element_rect(fill = \"#FFFFFF\"),\n        strip.text = element_text(size = 15),\n        panel.grid = element_blank(),\n        axis.ticks = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_text(size = 7),\n        panel.spacing = grid::unit(2, \"lines\"))\n    \n    grid.arrange(mon_radar_plot, global_radar_plot, \n                 know_radar_plot, dont_know_radar_plot, ncol=2, nrow=2)\n  })\n  \n  output$mon_ranking <- renderPlot({\n    asso_ranking %>% \n      filter(Associe == input$consultant_id) %>% \n      ggplot(aes(x = fct_reorder(qualite, son_rang), y = son_rang)) +\n      geom_bar(stat = \"identity\", fill = \"steelblue\", alpha = 0.8) +\n      labs(x = \"\",\n           y = \"Rang\",\n           title = \"Mon classement selon le cabinet\") +\n      scale_y_continuous(breaks = c(1, 2, 3, 4, 5), \n                         labels = c(\"1er\", \"2ème\", \"3ème\", \"4ème\", \"5ème\")) + \n      coord_flip(ylim = c(0, 5)) +\n      theme(\n        panel.background = element_rect(fill = \"#FFFFFF\"),\n        plot.background = element_rect(fill = \"#FFFFFF\"),\n        strip.background = element_rect(fill = \"#FFFFFF\"),\n        strip.text = element_text(size = 15),\n        panel.grid = element_blank(),\n        axis.ticks = element_blank(),\n        axis.text.x = element_text(size = 7),\n        panel.spacing = grid::unit(2, \"lines\"))\n  })\n  \n  output$view <- renderTable({\n    \n    datasetInput <- asso_ranking %>% \n      filter(Associe == input$consultant_id) %>%\n      select (qualite,score_moyen,moyenne, son_rang)\n    datasetInput$qualite[datasetInput$qualite == \"DEVELOPPEMENT\\nDES\\nCOLLABORATEURS\"] <- \"DEV. DES COLLABORATEURS\"\n     \n   colnames(datasetInput) <- c(\"Thème\",\"Note\",\"Moy.\",\"Rang\") \n    datasetInput}\n  )\n  \n  output$Connaissance <- renderTable({\n    datasetInput <- questionnaire_connaissance %>% \n      filter(Associe == input$consultant_id) %>% \n      group_by(response) %>% summarize(Avis= n())\n\n    colnames(datasetInput) <- c(\"Pertinence\",\"Nombre\") \n    datasetInput}\n  )\n})",
    "created" : 1486475639754.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3244620185",
    "id" : "DC99E64C",
    "lastKnownWriteTime" : 1486469068,
    "last_content_update" : 1486469068,
    "path" : "D:/tmp/PR/pr_augmented_A/server.R",
    "project_path" : "pr_augmented_A/server.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}