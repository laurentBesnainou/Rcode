{
    "collab_server" : "",
    "contents" : "# library(shiny)\n# library(shinydashboard)\n# library(dplyr)\n# library(ggplot2)\n# library(ggthemes)\n# library(RColorBrewer) #coulors pour ggplot\n# library(stringr)\n# library(lubridate) # gestion des dates\n# library(xts) #serie temporelle\n# library(dygraphs) #affichage de graphe avec affichage dynamique\n# library(forcats)\n# library(DT) # Affichage des tableaux dynamiques\n# library(purrr) #\n# library(tidyr)\n# library(scales)\n# library(googleVis) # Permet d'utiliser les graphiques >  Google Chart\n# library(timevis)# Gantt\n\n#On charge les données du questionnaire sur les associés\n#load(\"data/questionnaire_associe.RData\")\n#data_src <- data_Associe\n\n#Nombre de reponses dans le questionnaire\n# nbReponse <- nrow(data_Associe) - 1 \n# #nbReponsesAsso <- data_Associe %>% filter(!is.na(`e-mail`)) %>% nrow()\n# #ou regadre qui connait les associés\n# data_Associe_Avis <- data_Associe %>% gather(key = \"TYPE\", value = \"VALEUR\", AvisBrice, AvisOlivierG,AvisMarc,AvisOlivierR,AvisJulien)\n# \n# #Q1\n# data_Associe_Q1 <- data_src %>% gather(key = \"Q1\", value = \"VQ1\", Q1Brice,       Q1OlivierG,   Q1Marc,        Q1OlivierR,    Q1Julien)\n# \n# #Q2\n# data_Associe_Q2 <- data_src %>% gather(key = \"Q2\", value = \"VQ2\", Q2Brice,       Q2OlivierG,   Q2Marc,        Q2OlivierR,    Q2Julien)\n# \n# #Q3\n# data_Associe_Q3 <- data_src %>% gather(key = \"Q3\", value = \"VQ3\", Q3Brice,       Q3OlivierG,   Q3Marc,        Q3OlivierR,    Q3Julien)\n# \n# #Q4\n# data_Associe_Q4 <- data_src %>% gather(key = \"Q4\", value = \"VQ4\", Q4Brice,       Q4OlivierG,   Q4Marc,        Q4OlivierR,    Q4Julien)\n\n\n\n\nserver <- function(input, output, session) {\n  \n  \n  # Tableau <- reactive ({\n  #Dans un premier temps on regarde quels sont les Groupes qui ont un CA compris entre 2 valeurs\n  \n  \n  #   data_src%>% filter(`e-mail` == input$presonne) %>% \n  #     select (AvisBrice, AvisOlivierG,  AvisMarc,AvisOlivierR, AvisJulien) %>%\n  #     mutate (AvisBrice = ifelse(AvisBrice == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     mutate (AvisOlivierG = ifelse(AvisOlivierG == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     mutate (AvisMarc = ifelse(AvisMarc == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     mutate (AvisOlivierR = ifelse(AvisOlivierR == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     mutate (AvisJulien = ifelse(AvisJulien == TRUE,\"Connait\",\"Connait pas\"))\n  #   \n  # }) \n  \n  # output$DTTab1 = DT::renderDataTable(rownames = TRUE, options = list(searching = FALSE,paging = FALSE),\n  #                                     Tableau()\n  # )\n  \n  # Tableau2 <- reactive ({\n  #   #Dans un premier temps on regarde quels sont les Groupes qui ont un CA compris entre 2 valeurs\n  #   \n  #   \n  #   data_src%>% filter(`e-mail` == input$presonne) %>% \n  #     select (Q1Brice,Q1OlivierG,Q1Marc,Q1OlivierR) \n  #   \n  # }) \n  # \n  # output$DTTab2 = DT::renderDataTable(rownames = TRUE, options = list(searching = FALSE,paging = FALSE),\n  #                                     Tableau2()\n  # )\n  # \n  # Tableau3 <- reactive ({\n  #   #Dans un premier temps on regarde quels sont les Groupes qui ont un CA compris entre 2 valeurs\n  #   \n  #   \n  #   data_src%>% filter(`e-mail` == input$presonne) %>% \n  #     select (Q2Brice,Q2OlivierG,Q2Marc,Q2OlivierR) \n  #   \n  # }) \n  # \n  # output$DTTab3 = DT::renderDataTable(rownames = TRUE, options = list(searching = FALSE,paging = FALSE),\n  #                                     Tableau3()\n  # )\n  # \n  # \n  # Tableau4 <- reactive ({\n  #   #Dans un premier temps on regarde quels sont les Groupes qui ont un CA compris entre 2 valeurs\n  #   \n  #   \n  #   data_src%>% filter(`e-mail` == input$presonne) %>% \n  #     select (Q3Brice,Q3OlivierG,Q3Marc,Q3OlivierR) \n  #   \n  # }) \n  # \n  # output$DTTab4 = DT::renderDataTable(rownames = TRUE, options = list(searching = FALSE,paging = FALSE),\n  #                                     Tableau4()\n  # )\n  # \n  # \n  # Tableau5 <- reactive ({\n  #   #Dans un premier temps on regarde quels sont les Groupes qui ont un CA compris entre 2 valeurs\n  #   \n  #   \n  #   data_src%>% filter(`e-mail` == input$presonne) %>% \n  #     select (Q4Brice,Q4OlivierG,Q4Marc,Q4OlivierR) \n  #   \n  # }) \n  # \n  # output$DTTab4 = DT::renderDataTable(rownames = TRUE, options = list(searching = FALSE,paging = FALSE),\n  #                                     Tableau4()\n  # )\n  ################# Liste des Infobox  \n  \n  \n  output$A1 <- renderInfoBox({\n    infoBox(\"Nombre de réponses\", value = questionnaire_associe[[\"ID_consultant\"]] %>% unique() %>% length(),\n            \n            icon = icon(\"user-circle-o\"),\n            color= \"aqua\")\n  })\n  \n  output$A1_plot <- renderPlot({\n    cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#F6AE2D\")\n    my_answer <- questionnaire_associe %>% \n      filter(Question == \"Pour quelle personne ci-dessous considères-tu que ton avis n'est pas pertinent ?\", ID_consultant == 10) %>% \n      select(- Question) %>% \n      mutate(my_answer = 1) %>% \n      mutate(response = factor(response),\n             Associe = factor(Associe))\n    \n    q1_count <- questionnaire_associe %>% \n      filter(Question == \"Pour quelle personne ci-dessous considères-tu que ton avis n'est pas pertinent ?\") %>% \n      select(- Question) %>% \n      group_by(Associe, response) %>% \n      summarise(COUNT = n()) %>% \n      ungroup() %>% \n      mutate(response = factor(response),\n             Associe = factor(Associe)) %>% \n      left_join(my_answer, by = c(\"Associe\", \"response\")) %>% \n      replace_na(list(my_answer = 0.4)) \n    \n    q1_count %>% \n      ggplot(aes(x = Associe, y = COUNT, fill = response, alpha = my_answer, colour = my_answer)) +\n      geom_bar(stat = \"identity\", position = \"dodge\") +\n      viridis::scale_fill_viridis(discrete = TRUE) +\n      scale_alpha_identity() +\n      theme_bw()\n  })\n  \n  \n  # output$Q2_plot <- renderPlot({\n  #   QAll %>% filter (QUESTION == \"Q1\", TYPE %in% c(\"OUICONNAIT\",\"NONCONNAIT\",\"SPCONNAIT\") )%>%\n  #     ggplot(aes(x = TYPE,\n  #                y = VALEUR, fill= TYPE )) +\n  #     geom_bar(stat = \"identity\") +\n  #     scale_x_discrete(name=\"\",limit = c(\"OUICONNAIT\", \"NONCONNAIT\", \"SPCONNAIT\"))+\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     ggtitle(\"Question 1\")+\n  #     theme_hc() +\n  #     scale_colour_hc()\n  # })\n  # output$Q3_plot <- renderPlot({\n  #   QAll %>% filter (QUESTION == \"Q1\", TYPE %in% c(\"OUISAISPAS\",\"NONSAISPAS\",\"SPSAISPAS\") )%>%\n  #     ggplot(aes(x = TYPE,\n  #                y = VALEUR, fill= TYPE )) +\n  #     geom_bar(stat = \"identity\") +\n  #     scale_x_discrete(name=\"\",limit = c(\"OUISAISPAS\",\"NONSAISPAS\",\"SPSAISPAS\"))+\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     ggtitle(\"Question 1\")\n  # })\n  # \n  # \n  # \n  # output$Q1_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#F6AE2D\")\n  #   levels <- c(\"OUI\", \"NON\", \"SP\",\"OUICONNAIT\", \"NONCONNAIT\", \"SPCONNAIT\",\"OUISAISPAS\",\"NONSAISPAS\",\"SPSAISPAS\")\n  #   labels <- c(\"OUI\", \"NON\", \"SP\",\"OUI\", \"NON\", \"SP\",\"OUI\", \"SP\", \"NON\")\n  #   avis <- c(\"Total\", \"Total\", \"Total\",\"Connait\", \"Connait\", \"Connait\",\"SaisPAs\", \"SaisPAs\", \"SaisPAs\")\n  #   QAll %>% mutate(TYPE2 = labels[match(TYPE,levels)],\n  #                   TYPE3 = avis[match(TYPE,levels)]) %>%\n  #   filter (QUESTION == \"Q1\")%>% \n  #     mutate (TYPE3 = factor(TYPE3, levels=c(\"Total\", \"Connait\",\"SaisPAs\"))) %>%\n  #     ggplot(aes(x = TYPE2,\n  #                y = VALEUR, fill= TYPE3 )) +\n  #     geom_bar(stat = \"identity\", position = \"dodge\") +\n  #     scale_x_discrete(name=\"\",limit = c(\"OUI\",\"NON\",\"SP\"))+\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     ggtitle(\"Ce que BT pense de moi sur ce point - Répartition des reponses\")+\n  #     theme_economist() + scale_colour_economist() +scale_fill_manual(values=cbbPalette)\n  # })\n  # \n  # \n  # output$A1_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#F6AE2D\")\n  # \n  #   data_Associe_Avis %>%filter(!is.na(ID)) %>%\n  #     mutate(TYPE=str_replace_all(TYPE,\"Avis\",\"\")) %>%\n  #     select (TYPE,VALEUR) %>% group_by(TYPE) %>%\n  #     summarise(Total = sum(VALEUR, na.rm = TRUE))%>%\n  #     ggplot(aes(x = reorder(TYPE, -Total),\n  #                y = Total, fill= \"#F6AE2D\" )) +\n  #     geom_bar(stat = \"identity\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Mon Avis est pertinent pour - Associés\")+\n  #     theme_economist() + scale_colour_economist() +scale_fill_manual(values=cbbPalette) +\n  #     theme(legend.position=\"none\")\n  # })\n  # \n  # \n  # output$A2_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe_Q1 %>%filter(!is.na(ID)) %>% \n  #     mutate(Q1=str_replace_all(Q1,\"Q1\",\"\")) %>%\n  #     select (Q1,VQ1) %>% mutate (VQ1=factor(VQ1)) %>% group_by(Q1,VQ1) %>% summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1,y = nb,fill=VQ1) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1 - Associés\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     #scale_fill_manual(values=cbbPalette) +\n  #     theme(legend.position=\"bottom\")\n  # })\n  # \n  # output$A3_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe_Q2 %>%filter(!is.na(ID)) %>% \n  #     mutate(Q2=str_replace_all(Q2,\"Q2\",\"\")) %>%\n  #     select (Q2,VQ2) %>% mutate (VQ2=factor(VQ2)) %>% group_by(Q2,VQ2) %>% summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q2,y = nb,fill=VQ2) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 2 - Associés\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     theme(legend.position=\"bottom\")\n  # })\n  # \n  # output$A4_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe_Q3 %>%filter(!is.na(ID)) %>% \n  #     mutate(Q3=str_replace_all(Q3,\"Q3\",\"\")) %>%\n  #     select (Q3,VQ3) %>% mutate (VQ3=factor(VQ3)) %>% group_by(Q3,VQ3) %>% summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q3,y = nb,fill=VQ3) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 3 - Associés\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     #scale_fill_manual(values=cbbPalette) +\n  #     theme(legend.position=\"bottom\")\n  # })\n  # \n  # output$A5_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe_Q4 %>%filter(!is.na(ID)) %>% \n  #     mutate(Q4=str_replace_all(Q4,\"Q4\",\"\")) %>%\n  #     select (Q4,VQ4) %>% mutate (VQ4=factor(VQ4)) %>% group_by(Q4,VQ4) %>% summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q4,y = nb,fill=VQ4) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 4 - Associés\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     #scale_fill_manual(values=cbbPalette) +\n  #     theme(legend.position=\"bottom\")\n  # })\n  # \n  # output$A1bis_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe %>%filter(!is.na(ID)) %>%\n  #     mutate (AvisBrice = ifelse(AvisBrice == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     select (Q1Brice,AvisBrice) %>% mutate (AvisBrice=factor(AvisBrice)) %>% group_by(AvisBrice,Q1Brice) %>% \n  #     summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1Brice,y = nb, fill=AvisBrice) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1  En fonction de la connaissance - pour Brice\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     facet_wrap( ~ AvisBrice)\n  # })\n  # \n  # output$A2bis_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe %>%filter(!is.na(ID)) %>%\n  #     mutate (AvisOlivierG = ifelse(AvisBrice == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     select (Q1OlivierG,AvisOlivierG) %>% mutate (AvisOlivierG=factor(AvisOlivierG)) %>% group_by(AvisOlivierG,Q1OlivierG) %>% \n  #     summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1OlivierG,y = nb, fill=AvisOlivierG) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1  En fonction de la connaissance - pour OlivierG\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     facet_wrap( ~ AvisOlivierG)\n  # })\n  # \n  # \n  # output$A3bis_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe %>%filter(!is.na(ID)) %>%\n  #     mutate (AvisMarc = ifelse(AvisMarc == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     select (Q1Marc,AvisMarc) %>% mutate (AvisMarc=factor(AvisMarc)) %>% group_by(AvisMarc,Q1Marc) %>% \n  #     summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1Marc,y = nb, fill=AvisMarc) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1  En fonction de la connaissance - pour Marc\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     facet_wrap( ~ AvisMarc)\n  # })\n  # \n  # output$A4bis_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe %>%filter(!is.na(ID)) %>%\n  #     mutate (AvisOlivierR = ifelse(AvisOlivierR == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     select (Q1OlivierR,AvisOlivierR) %>% mutate (AvisOlivierR=factor(AvisOlivierR)) %>% group_by(AvisOlivierR,Q1OlivierR) %>% \n  #     summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1OlivierR,y = nb, fill=AvisOlivierR) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1  En fonction de la connaissance - pour OlivierR\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     facet_wrap( ~ AvisOlivierR)\n  # })\n  # \n  # output$A5bis_plot <- renderPlot({\n  #   cbbPalette <- c(\"#00A8E8\", \"#33658A\", \"#9BC995\",\"#F6AE2D\")\n  #   \n  #   data_Associe %>%filter(!is.na(ID)) %>%\n  #     mutate (AvisMarc = ifelse(AvisMarc == TRUE,\"Connait\",\"Connait pas\")) %>%\n  #     select (Q1Marc,AvisMarc) %>% mutate (AvisMarc=factor(AvisMarc)) %>% group_by(AvisMarc,Q1Marc) %>% \n  #     summarise(nb=n()) %>%\n  #     ggplot(aes(x = Q1Marc,y = nb, fill=AvisMarc) )+\n  #     geom_bar(stat = \"identity\", position = \"Dodge\") +\n  #     scale_y_continuous(name=\"Reponses\")+\n  #     scale_x_discrete(name=\"Associés\") +\n  #     ggtitle(\"Question 1  En fonction de la connaissance - pour Julien\")+\n  #     theme_economist() + scale_colour_economist() +\n  #     scale_fill_manual(values=cbbPalette) +\n  #     facet_wrap( ~ AvisMarc)\n  # })\n}",
    "created" : 1485869790981.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "277829418",
    "id" : "22454A9F",
    "lastKnownWriteTime" : 6,
    "last_content_update" : 1485869793035,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}