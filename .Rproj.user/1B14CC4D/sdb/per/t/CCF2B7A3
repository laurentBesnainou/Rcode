{
    "collab_server" : "",
    "contents" : "# Load libs ----\nlibrary(readxl)\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(stringr)\n\n# Auxiliary functions ----\nremove_html_str <- function(str_vec) {\n  str_trim(str_replace_all(str_vec, \"<.*?>\", \"\"))\n}\n\n# Formulaire Associé ----\n# Load data\ndata_associe <- read_excel(\"raw-data/PR2017 - PERF2016 - A_Datalab.xls\", col_names = FALSE)\n\n# on supprime les colonnes vides ----\nnbr_cols <- ncol(data_associe)\nnbr_rows <- nrow(data_associe)\nnull_cols <- vector()\nfor (i in seq_len(nbr_cols)) {\n  if (sum(is.na(data_associe[[i]]))/(nbr_rows - 1) == 1) {\n    null_cols <- c(null_cols, i)\n  }\n}\n\ndata_associe[null_cols] <- NULL\n\n# Position des questions ----\nq1_str <- \"Pour quelle personne ci-dessous considères-tu que ton avis n'est pas pertinent ?\"\nq2_str <- \"Dans quelle mesure considères-tu que les associés suivants incarnent la valeur de leadership ?\"\nq3_str <- \"Dans quelle mesure considères-tu que les associés suivants sont porteurs de vision ?\"\nq4_str <- \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant l'origination commerciale ?\"\nq5_str <- \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant le développement des collaborateurs ?\"\n\nq1_cols <- 7:11\nq2_cols <- 12:16\nq3_cols <- 17:21\nq4_cols <- 22:26\nq5_cols <- 27:31\nq2_5 <- 12:31\n\nquestion_rows <- data_associe[1, ]\nname_rows <- data_associe[2, ]\n\nfor (i in q1_cols) {\n  data_associe[1, i] <- q1_str\n  data_associe[2, i] <- str_trim(str_split(remove_html_str(data_associe[2, i]), \" - \")[[1]][1])\n}\n\nfor (i in q2_5) {\n  data_associe[1, i] <- remove_html_str(data_associe[1, i])\n  data_associe[2, i] <- remove_html_str(data_associe[2, i])\n}\n\n# remplace les questions vides ----\nfor (i in q2_cols) {\n  data_associe[1, i] <- q2_str\n}\n\nfor (i in q3_cols) {\n  data_associe[1, i] <- q3_str\n}\n\nfor (i in q4_cols) {\n  data_associe[1, i] <- q4_str\n}\n\nfor (i in q5_cols) {\n  data_associe[1, i] <- q5_str\n}\n\n# recoding reponses: Content Mécotent Neutre ----\nfor (i in q2_5) {\n  data_associe[[i]][-c(1,2)] <- ifelse(str_detect(data_associe[[i]][-c(1,2)], \"Content\"), \"Content\", \n                                       ifelse(str_detect(data_associe[[i]][-c(1,2)], \"Mécontent\"), \n                                              \"Mécontent\", \"Neutre\"))\n}\n\nfor (i in c(q1_cols, q2_5)) {\n  data_associe[1, i] <- str_c(data_associe[1, i], data_associe[2, i], sep = \" - \")\n}\n\ndata_associe <- data_associe[-2, ]\ncolnames(data_associe) <- data_associe[1, ]\ndata_associe <- data_associe[-1, ]\ndata_associe[[6]] <- data_associe[[6]] %>% as.numeric()\n\nirrelevant_cols <- c(1:5, 32)\ndata_associe[irrelevant_cols] <- NULL\n\ncolnames(data_associe)[1] <- \"ID_consultant\"\ndata_tidy <- data_associe %>% gather(key=QA, value=response, - ID_consultant)\ndata_tidy <- data_tidy %>% separate(QA, into=c(\"Question\", \"Associe\"), sep = \" - \")\nquestionnaire_associe <- data_tidy\n\n# Extra info from global ----\naccessible_ID <- c(32, 33, 61, 62)\nnames(accessible_ID) <- c(\"Julien Soyer\", \"Olivier Reisse\", \"Brice Escarguel\", \"Olivier Grandjean\")\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(ID_cible = accessible_ID[Associe])\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(Associe = str_trim(Associe)) %>% \n  mutate(response = ifelse(Question == q1_str,\n                           ifelse(is.na(response), \"Je connais\", \"Je ne connais pas\"), \n                           response))\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(qualite = recode(Question,\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent la valeur de leadership ?\" = \"LEADERSHIP\",\n                          \"Dans quelle mesure considères-tu que les associés suivants sont porteurs de vision ?\" = \"VISION\",\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant l'origination commerciale ?\" = \"ORIGINATION\\nCOMMERCIALE\",\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant le développement des collaborateurs ?\" = \"DEVELOPPEMENT\\nDES\\nCOLLABORATEURS\"))\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(score = recode(response,\n                        \"Je connais\" = 1,\n                        \"Je ne connais pas\" = 0,\n                        \"Content\" = 3,\n                        \"Neutre\" = 2,\n                        \"Mécontent\" = 1,\n                        .missing = 0))\n\nsave(questionnaire_associe, file=\"pr_augmented_A/data/questionnaire_associe.RData\")\n\n# Formulaire Directeur / Manager ----\ndata_manager <- read_excel(\"raw-data/PR2017 - PERF2016 - M_Datalab.xls\", col_names = FALSE)\n\nnbr_cols <- ncol(data_manager)\nnbr_rows <- nrow(data_manager)\n\nnull_cols <- vector()\nfor (i in seq_len(nbr_cols)) {\n  if (sum(is.na(data_manager[[i]]))/(nbr_rows - 1) == 1) {\n    null_cols <- c(null_cols, i)\n  }\n}\ndata_manager[null_cols] <- NULL\n\nirrelevant_cols <- 1:5\ndata_manager[irrelevant_cols] <- NULL\n\nq1_str <- \"Pour quelle personne ci-dessous considères-tu que ton avis n'est pas pertinent ?\"\nq2_str <- \"Dans quelle mesure considères-tu que les personnes suivantes incarnent la proposition de valeur BT ?\"\nq3_str <- \"Dans quelle mesure considères-tu que les personnes suivants encouragent et créent les conditions nécessaires à l'incarnation de la proposition de valeur BT ?\"\nq4_str <- \"Dans quelle mesure considères-tu que les personnes suivantes sont des bons managers opérationnels (direction de mission ou de dispositif interne) ?\"\nq5_str <- \"Dans quelle mesure considères-tu que les personnes suivantes sont des bons coachs ?\"\n\nq1_cols <- 2:22\nq2_cols <- 23:43\nq3_cols <- 44:64\nq4_cols <- 65:85\nq5_cols <- 86:106\nq2_5 <- 23:106\n\nquestion_rows <- data_manager[1, ]\nname_rows <- data_manager[2, ]\n\nfor (i in q1_cols) {\n  data_manager[1, i] <- q1_str\n  data_manager[2, i] <- str_trim(str_split(remove_html_str(data_manager[2, i]), \" - \")[[1]][1])\n}\n\nfor (i in q2_5) {\n  data_manager[1, i] <- remove_html_str(data_manager[1, i])\n  data_manager[2, i] <- remove_html_str(data_manager[2, i])\n}\n\n# remplace les questions vides ----\nfor (i in q2_cols) {\n  data_manager[1, i] <- q2_str\n}\n\nfor (i in q3_cols) {\n  data_manager[1, i] <- q3_str\n}\n\nfor (i in q4_cols) {\n  data_manager[1, i] <- q4_str\n}\n\nfor (i in q5_cols) {\n  data_manager[1, i] <- q5_str\n}\n\n# recoding reponses: Content Mécotent Neutre ----\nfor (i in q2_5) {\n  data_manager[[i]][-c(1,2)] <- ifelse(str_detect(data_manager[[i]][-c(1,2)], \"Content\"), \"Content\", \n                                       ifelse(str_detect(data_manager[[i]][-c(1,2)], \"Mécontent\"), \n                                              \"Mécontent\", \"Neutre\"))\n}\n\nfor (i in c(q1_cols, q2_5)) {\n  data_manager[1, i] <- str_c(data_manager[1, i], data_manager[2, i], sep = \" - \")\n}\n\ndata_manager <- data_manager[-2, ]\ncolnames(data_manager) <- data_manager[1, ]\ndata_manager <- data_manager[-1, ]\ndata_manager[[1]] <- data_manager[[1]] %>% as.numeric()\n\ncolnames(data_manager)[1] <- \"ID_consultant\"\ndata_tidy <- data_manager %>% gather(key=QA, value=response, - ID_consultant)\ndata_tidy <- data_tidy %>% \n  filter(QA != \"As-tu des éléments à partager ?\")\ndata_tidy <- data_tidy %>% separate(QA, into=c(\"Question\", \"DM\"), sep = \" - \")\nquestionnaire_dm <- data_tidy\n\n# Extra info from global ----\naccessible_ID <- c(32, 33, 61, 62)\nnames(accessible_ID) <- c(\"Julien Soyer\", \"Olivier Reisse\", \"Brice Escarguel\", \"Olivier Grandjean\")\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(ID_cible = accessible_ID[Associe])\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(Associe = str_trim(Associe)) %>% \n  mutate(response = ifelse(Question == q1_str,\n                           ifelse(is.na(response), \"Je connais\", \"Je ne connais pas\"), \n                           response))\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(qualite = recode(Question,\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent la valeur de leadership ?\" = \"LEADERSHIP\",\n                          \"Dans quelle mesure considères-tu que les associés suivants sont porteurs de vision ?\" = \"VISION\",\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant l'origination commerciale ?\" = \"ORIGINATION\\nCOMMERCIALE\",\n                          \"Dans quelle mesure considères-tu que les associés suivants incarnent un savoir-faire et savoir-être permettant le développement des collaborateurs ?\" = \"DEVELOPPEMENT\\nDES\\nCOLLABORATEURS\"))\n\nquestionnaire_associe <- questionnaire_associe %>% \n  mutate(score = recode(response,\n                        \"Je connais\" = 1,\n                        \"Je ne connais pas\" = 0,\n                        \"Content\" = 3,\n                        \"Neutre\" = 2,\n                        \"Mécontent\" = 1,\n                        .missing = 0))\n\nsave(questionnaire_dm, file=\"pr_augmented_M/data/questionnaire_dm.RData\")\n\n# Formulaire Consultants ----\ndata_consultant <- read_excel(\"raw-data/PR2017 - PERF2016 - C_Datalab.xls\", col_names = FALSE)\n\nnbr_cols <- ncol(data_consultant)\nnbr_rows <- nrow(data_consultant)\n\nnull_cols <- vector()\nfor (i in seq_len(nbr_cols)) {\n  if (sum(is.na(data_consultant[[i]]))/(nbr_rows - 1) == 1) {\n    null_cols <- c(null_cols, i)\n  }\n}\ndata_consultant[null_cols] <- NULL\n\nirrelevant_cols <- 1:5\ndata_consultant[irrelevant_cols] <- NULL\n\nq1_str <- \"Pour quelle personne ci-dessous considères-tu que ton avis n'est pas pertinent ?\"\nq2_str <- \"Dans quelle mesure considères-tu que les personnes suivantes pensent Business Technology ?\"\nq3_str <- \"Dans quelle mesure considères-tu que les personnes suivantes pensent différemment ?\"\nq4_str <- \"Dans quelle mesure considères-tu que les personnes suivantes contribuent à l'intelligence connective ?\"\nq5_str <- \"Dans quelle mesure considères-tu que les personnes suivantes savent tirer profit de la diversité créatrice de valeur ?\"\n\nq1_cols <- 2:33\nq2_cols <- 34:65\nq3_cols <- 66:97\nq4_cols <- 98:129\nq5_cols <- 130:161\nq2_5 <- 34:161\n\nquestion_rows <- data_consultant[1, ]\nname_rows <- data_consultant[2, ]\n\nfor (i in q1_cols) {\n  data_consultant[1, i] <- q1_str\n  data_consultant[2, i] <- str_trim(str_split(remove_html_str(data_consultant[2, i]), \" - \")[[1]][1])\n}\n\nfor (i in q2_5) {\n  data_consultant[1, i] <- remove_html_str(data_consultant[1, i])\n  data_consultant[2, i] <- remove_html_str(data_consultant[2, i])\n}\n\n# remplace les questions vides ----\nfor (i in q2_cols) {\n  data_consultant[1, i] <- q2_str\n}\n\nfor (i in q3_cols) {\n  data_consultant[1, i] <- q3_str\n}\n\nfor (i in q4_cols) {\n  data_consultant[1, i] <- q4_str\n}\n\nfor (i in q5_cols) {\n  data_consultant[1, i] <- q5_str\n}\n\n# recoding reponses: Content Mécotent Neutre ----\nfor (i in q2_5) {\n  data_consultant[[i]][-c(1,2)] <- ifelse(str_detect(data_consultant[[i]][-c(1,2)], \"Content\"), \"Content\", \n                                       ifelse(str_detect(data_consultant[[i]][-c(1,2)], \"Mécontent\"), \n                                              \"Mécontent\", \"Neutre\"))\n}\n\nfor (i in c(q1_cols, q2_5)) {\n  data_consultant[1, i] <- str_c(data_consultant[1, i], data_consultant[2, i], sep = \" - \")\n}\n\ndata_consultant <- data_consultant[-2, ]\ncolnames(data_consultant) <- data_consultant[1, ]\ndata_consultant <- data_consultant[-1, ]\ndata_consultant[[1]] <- data_consultant[[1]] %>% as.numeric()\n\ncolnames(data_consultant)[1] <- \"ID_consultant\"\ndata_tidy <- data_consultant %>% gather(key=QA, value=response, - ID_consultant)\ndata_tidy <- data_tidy %>% \n  filter(QA != \"As-tu des éléments à partager ?\")\ndata_tidy <- data_tidy %>% separate(QA, into=c(\"Question\", \"Consultant\"), sep = \" - \")\nquestionnaire_consultant <- data_tidy\n\nsave(questionnaire_consultant, file=\"pr_augmented_C/data/questionnaire_consultant.RData\")\n",
    "created" : 1487761765861.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2209158241",
    "id" : "CCF2B7A3",
    "lastKnownWriteTime" : 1486463186,
    "last_content_update" : 1486463186,
    "path" : "D:/tmp/PR/process-raw-data.R",
    "project_path" : "PR/process-raw-data.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}