{
    "collab_server" : "",
    "contents" : "library(devtools)\ndevtools::install_github('davidgohel/ReporteRsjars')\ndevtools::install_github('davidgohel/ReporteRs')\ninstall.packages(c('ReporteRs', 'haven', 'vcd', 'ggplot2', 'reshape2'))\nlibrary(ReporteRs)\nlibrary(haven)\nlibrary(vcd)\nlibrary(ggplot2)\nlibrary(reshape2)\ndat = read_spss(\"http://wiki.q-researchsoftware.com/images/9/94/GSSforDIYsegmentation.sav\")\nfilename = \"c://delete//Significant crosstabs.pptx\" # the document to produce\ndocument = pptx(title = \"My significant crosstabs!\")\nalpha = 0.05 # The level at which the statistical testing is to be done.\ndependent.variable.names = c(\"wrkstat\", \"marital\", \"sibs\", \"age\", \"educ\")\nall.names = names(dat)[6:55] # The first 50 variables int the file.\ncounter = 0\nfor (nm in all.names)\n  for (dp in dependent.variable.names)\n  {\n    if (nm != dp)\n    {\n      v1 = dat[[nm]]\n      if (is.labelled(v1))\n        v1 = as_factor(v1)\n      v2 = dat[[dp]]\n      l1 = attr(v1, \"label\")\n      l2 = attr(v2, \"label\")\n      if (is.labelled(v2))\n        v2 = as_factor(v2)\n      if (length(unique(v1)) <= 10 <= 10) # Only performing tests if 10 or fewer rows and columns. { \n        x = xtabs(~v1 + v2) \n      x = x[rowSums(x) > 0, colSums(x) > 0]\n      ch = chisq.test(x)\n      p = ch$p.value\n      if (!is.na(p) && p <= alpha)\n      {\n        counter = counter + 1\n        # Creating the outputs.\n        crosstab = prop.table(x, 2) * 100\n        melted = melt(crosstab)\n        melted$position = 100 - as.numeric(apply(crosstab, 2, cumsum) - 0.5 * crosstab)\n        p <- ggplot(melted, aes(x = v2, y = value,fill = v1)) + geom_bar(stat='identity')\n        p  <-  p + geom_text(data = melted, aes(x = v2, y = position, label = paste0(round(value, 0),\"%\")), size=4)\n        p  <-  p + labs(x = l2, y = l1)\n        colnames(crosstab)  <-  paste0(colnames(crosstab), \"%\")\n        #bar = ggplot() + geom_bar(aes(y = v1, x = v2), data = data.frame(v1, v2), stat=\"identity\")\n        # Writing them to the PowerPoint document.\n        document = addSlide(document, slide.layout = \"Title and Content\" )\n        document = addTitle(document, paste0(\"Standardized residuals and chart: \", l1, \" by \", l2))\n        document = addPlot(doc = document, fun = print, x = p, offx = 3, offy = 1, width = 6, height = 5 )\n        document = addFlexTable(doc = document, FlexTable(round(ch$stdres, 1), add.rownames = TRUE),offx = 8, offy = 2, width = 4.5, height = 3 )\n      }\n    }\n    \n  }\n}\nwriteDoc(document, file = filename )        \ncat(paste0(counter, \" tables and charges exported to \", filename, \".\"))\n\n\nlibrary(ReporteRs)\nlibrary(magrittr)\n\nmydoc <- docx() %>%\n  addParagraph(value = 'Correlation matrix', style='Titre2') %>%\n  addParagraph(value='Estimates') %>%\n  addFlexTable(FlexTable(cormat)) %>%\n  addParagraph(value = 'P-values') %>%\n  addFlexTable(FlexTable(corpval)) %>%\n  addParagraph(value = \"Boxplots\", style='Titre2') %>%\n  addPlot(fun=print, x = plt, height=3, width=5) %>%\n  writeDoc(file = 'Report.docx')\n\n\n\nlibrary(ReporteRs)\n# Create a word document to contain R outputs\ndoc <- docx()\n# Add a title to the document\ndoc <- addTitle(doc, \"Simple Word document\", level=1)\n# Add a paragraph of text into the Word document \ndoc <- addParagraph(doc, \"This simple Word document is created using R software and ReporteRs package. It contains just a simple text.\")\n# Add a sub title\ndoc <- addTitle(doc, \"What is R language?\", level = 2) \ndoc <- addParagraph(doc, \"R is a language and environment for statistical computing and graphics. R provides a wide variety of statistical and graphical techniques, and is highly extensible.\")\ndoc <- addTitle(doc, \"What is ReporteRs\", level = 2)\ndoc <- addParagraph(doc, \"ReporteRs is a package to write and format easily a Word document from R software.\")\n# Write the Word document to a file \nwriteDoc(doc, file = \"r-reporters-simple-word-document.docx\")",
    "created" : 1504179279233.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "1687363670",
    "id" : "9F31F799",
    "lastKnownWriteTime" : 199666352,
    "last_content_update" : 1504179885137,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}